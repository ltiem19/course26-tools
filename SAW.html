<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rayleigh Surface Acoustic Wave Visualization</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            border: 3px solid white;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        input[type="range"]::-moz-range-thumb {
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            border: 3px solid white;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        @media (min-width: 640px) {
            input[type="range"]::-webkit-slider-thumb {
                width: 32px;
                height: 32px;
            }
            input[type="range"]::-moz-range-thumb {
                width: 32px;
                height: 32px;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        const SAWVisualization = () => {
            const canvasRef = useRef(null);
            const containerRef = useRef(null);
            const [amplitude, setAmplitude] = useState(1.5);
            const [wavelengthMultiplier, setWavelengthMultiplier] = useState(2.6);
            const [showStrain, setShowStrain] = useState(false);
            const timeRef = useRef(0);
            const animationRef = useRef(null);

            useEffect(() => {
                const canvas = canvasRef.current;
                const container = containerRef.current;
                if (!canvas || !container) return;
                
                const updateCanvasSize = () => {
                    const rect = container.getBoundingClientRect();
                    canvas.width = rect.width;
                    canvas.height = rect.height;
                };
                
                updateCanvasSize();
                window.addEventListener('resize', updateCanvasSize);
                
                const ctx = canvas.getContext('2d');
                
                const animate = () => {
                    timeRef.current += 1;
                    
                    const width = canvas.width;
                    const height = canvas.height;
                    
                    const baseSpacing = Math.min(width, height) / 35;
                    const nX = Math.floor(width / baseSpacing) - 2;
                    const nY = Math.floor(height / baseSpacing * 0.6);
                    const spacingX = width / (nX + 2);
                    const spacingY = height / (nY + 5);
                    
                    const wavelength = 8 * spacingX * wavelengthMultiplier;
                    const k = (2 * Math.PI) / wavelength;
                    const omega = 0.06;
                    
                    const t = timeRef.current;
                    
                    const gradient = ctx.createLinearGradient(0, 0, 0, height);
                    gradient.addColorStop(0, '#f8f9fa');
                    gradient.addColorStop(1, '#e9ecef');
                    ctx.fillStyle = gradient;
                    ctx.fillRect(0, 0, width, height);
                    
                    const surfaceY = spacingY * 2;
                    
                    for (let iy = 0; iy < nY; iy++) {
                        for (let ix = 0; ix < nX; ix++) {
                            const x0 = spacingX * (ix + 1);
                            const y0 = surfaceY + spacingY * (iy + 1);
                            
                            const depth = iy * spacingY;
                            
                            const penetrationScale = 0.3 + (1.5 - amplitude) * 0.5;
                            const decayFactor = Math.exp(-k * depth * penetrationScale);
                            
                            const phase = k * x0 - omega * t;
                            
                            const ux = amplitude * spacingX * 0.15 * decayFactor * Math.cos(phase);
                            const uy = -amplitude * spacingY * 0.8 * decayFactor * Math.sin(phase);
                            
                            const x = x0 + ux;
                            const y = y0 + uy;
                            
                            const atomRadius = Math.max(3, baseSpacing * 0.2);
                            
                            let baseColor = { r: 120, g: 120, b: 130 };
                            
                            if (showStrain) {
                                const strain = -amplitude * Math.sin(phase) * decayFactor;
                                
                                if (strain > 0) {
                                    const intensity = Math.min(1, strain * 2);
                                    baseColor = {
                                        r: 120 + Math.floor(135 * intensity),
                                        g: 120 - Math.floor(70 * intensity),
                                        b: 130 - Math.floor(80 * intensity)
                                    };
                                } else {
                                    const intensity = Math.min(1, -strain * 2);
                                    baseColor = {
                                        r: 120 - Math.floor(70 * intensity),
                                        g: 120 - Math.floor(30 * intensity),
                                        b: 130 + Math.floor(125 * intensity)
                                    };
                                }
                            }
                            
                            const atomGradient = ctx.createRadialGradient(
                                x - atomRadius * 0.3, 
                                y - atomRadius * 0.3, 
                                0, 
                                x, 
                                y, 
                                atomRadius
                            );
                            
                            atomGradient.addColorStop(0, `rgb(${baseColor.r + 40}, ${baseColor.g + 40}, ${baseColor.b + 40})`);
                            atomGradient.addColorStop(0.7, `rgb(${baseColor.r}, ${baseColor.g}, ${baseColor.b})`);
                            atomGradient.addColorStop(1, `rgb(${baseColor.r - 30}, ${baseColor.g - 30}, ${baseColor.b - 30})`);
                            
                            ctx.fillStyle = atomGradient;
                            ctx.beginPath();
                            ctx.arc(x, y, atomRadius, 0, 2 * Math.PI);
                            ctx.fill();
                            
                            ctx.fillStyle = `rgba(255, 255, 255, ${0.4 * decayFactor})`;
                            ctx.beginPath();
                            ctx.arc(x - atomRadius * 0.35, y - atomRadius * 0.35, atomRadius * 0.3, 0, 2 * Math.PI);
                            ctx.fill();
                            
                            if (showStrain) {
                                const strain = -amplitude * Math.sin(phase) * decayFactor;
                                if (strain > 0) {
                                    ctx.strokeStyle = `rgba(255, 100, 100, ${0.3 * Math.abs(strain)})`;
                                } else {
                                    ctx.strokeStyle = `rgba(100, 150, 255, ${0.3 * Math.abs(strain)})`;
                                }
                            } else {
                                ctx.strokeStyle = `rgba(150, 150, 160, 0.2)`;
                            }
                            ctx.lineWidth = 1.5;
                            ctx.beginPath();
                            ctx.arc(x, y, atomRadius + 1, 0, 2 * Math.PI);
                            ctx.stroke();
                        }
                    }
                    
                    animationRef.current = requestAnimationFrame(animate);
                };
                
                animate();
                
                return () => {
                    window.removeEventListener('resize', updateCanvasSize);
                    if (animationRef.current) {
                        cancelAnimationFrame(animationRef.current);
                    }
                };
            }, [amplitude, wavelengthMultiplier, showStrain]);

            return (
                <div className="w-full h-screen bg-gray-50 flex flex-col">
                    <div className="bg-white border-b border-gray-200 p-4 sm:p-6 shadow-sm">
                        <h1 className="text-xl sm:text-2xl md:text-3xl font-bold text-gray-800 mb-4 sm:mb-6 text-center">
                            Rayleigh Surface Acoustic Wave
                        </h1>
                        
                        <div className="max-w-2xl mx-auto px-2 sm:px-4 space-y-4">
                            <div>
                                <label className="text-gray-700 text-sm font-semibold mb-2 block">
                                    Amplitude
                                </label>
                                <input
                                    type="range"
                                    min="0"
                                    max="1.5"
                                    step="0.01"
                                    value={amplitude}
                                    onChange={(e) => setAmplitude(parseFloat(e.target.value))}
                                    className="w-full h-3 sm:h-4 bg-gradient-to-r from-blue-200 to-blue-400 rounded-lg appearance-none cursor-pointer"
                                    style={{
                                        WebkitAppearance: 'none',
                                        appearance: 'none',
                                    }}
                                />
                            </div>
                            
                            <div>
                                <label className="text-gray-700 text-sm font-semibold mb-2 block">
                                    Wavelength
                                </label>
                                <input
                                    type="range"
                                    min="1.2"
                                    max="2.6"
                                    step="0.1"
                                    value={wavelengthMultiplier}
                                    onChange={(e) => setWavelengthMultiplier(parseFloat(e.target.value))}
                                    className="w-full h-3 sm:h-4 bg-gradient-to-r from-purple-200 to-purple-400 rounded-lg appearance-none cursor-pointer"
                                    style={{
                                        WebkitAppearance: 'none',
                                        appearance: 'none',
                                    }}
                                />
                            </div>
                            
                            <div className="flex justify-center">
                                <button
                                    onClick={() => setShowStrain(!showStrain)}
                                    className={`px-4 sm:px-6 py-2 sm:py-3 rounded-lg font-semibold text-sm sm:text-base transition-all ${
                                        showStrain 
                                            ? 'bg-gradient-to-r from-blue-500 to-red-500 text-white shadow-lg' 
                                            : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                    }`}
                                >
                                    {showStrain ? 'Hide' : 'Show'} Stress/Strain
                                </button>
                            </div>
                            
                            {showStrain && (
                                <div className="flex justify-center gap-4 text-xs sm:text-sm text-gray-600">
                                    <span className="flex items-center gap-2">
                                        <span className="w-3 h-3 rounded-full bg-blue-500"></span>
                                        Compression
                                    </span>
                                    <span className="flex items-center gap-2">
                                        <span className="w-3 h-3 rounded-full bg-red-500"></span>
                                        Tension
                                    </span>
                                </div>
                            )}
                        </div>
                    </div>
                    <div ref={containerRef} className="flex-1 overflow-hidden">
                        <canvas 
                            ref={canvasRef}
                            className="w-full h-full"
                        />
                    </div>
                </div>
            );
        };

        ReactDOM.render(<SAWVisualization />, document.getElementById('root'));
    </script>
</body>
</html>


